{
  "url": "https://docs.anthropic.com/en/docs/claude-code/troubleshooting",
  "markdown": "# Troubleshooting - Anthropic\n[Anthropic home page![light logo](https://mintlify.s3.us-west-1.amazonaws.com/anthropic/logo/light.svg)![dark logo](https://mintlify.s3.us-west-1.amazonaws.com/anthropic/logo/dark.svg)](https://docs.anthropic.com/)\nEnglish\nSearch...\n-   [Research](https://www.anthropic.com/research)\n-   [Login](https://console.anthropic.com/login)\n-   [Support](https://support.anthropic.com/)\n-   [Sign up](https://console.anthropic.com/login)\n-   [\n    Sign up\n    ](https://console.anthropic.com/login)\nSearch...\nNavigation\nBuild with Claude Code\nTroubleshooting\n[Welcome\n](https://docs.anthropic.com/en/home)[Developer Platform\n](https://docs.anthropic.com/en/docs/intro)[Claude Code\n](https://docs.anthropic.com/en/docs/claude-code/overview)[Model Context Protocol (MCP)\n](https://docs.anthropic.com/en/docs/mcp)[API Reference\n](https://docs.anthropic.com/en/api/messages)[Resources\n](https://docs.anthropic.com/en/resources/overview)[Release Notes\n](https://docs.anthropic.com/en/release-notes/overview)\n##### Getting started\n-   [\n    Overview\n    ](https://docs.anthropic.com/en/docs/claude-code/overview)\n-   [\n    Quickstart\n    ](https://docs.anthropic.com/en/docs/claude-code/quickstart)\n-   [\n    Common workflows\n    ](https://docs.anthropic.com/en/docs/claude-code/common-workflows)\n##### Build with Claude Code\n-   [\n    Claude Code SDK\n    ](https://docs.anthropic.com/en/docs/claude-code/sdk)\n-   [\n    Sub agents\n    ](https://docs.anthropic.com/en/docs/claude-code/sub-agents)\n-   [\n    Claude Code hooks\n    ](https://docs.anthropic.com/en/docs/claude-code/hooks-guide)\n-   [\n    GitHub Actions\n    ](https://docs.anthropic.com/en/docs/claude-code/github-actions)\n-   [\n    Model Context Protocol (MCP)\n    ](https://docs.anthropic.com/en/docs/claude-code/mcp)\n-   [\n    Troubleshooting\n    ](https://docs.anthropic.com/en/docs/claude-code/troubleshooting)\n##### Deployment\n-   [\n    Overview\n    ](https://docs.anthropic.com/en/docs/claude-code/third-party-integrations)\n-   [\n    Amazon Bedrock\n    ](https://docs.anthropic.com/en/docs/claude-code/amazon-bedrock)\n-   [\n    Google Vertex AI\n    ](https://docs.anthropic.com/en/docs/claude-code/google-vertex-ai)\n-   [\n    Corporate proxy\n    ](https://docs.anthropic.com/en/docs/claude-code/corporate-proxy)\n-   [\n    LLM gateway\n    ](https://docs.anthropic.com/en/docs/claude-code/llm-gateway)\n-   [\n    Development containers\n    ](https://docs.anthropic.com/en/docs/claude-code/devcontainer)\n##### Administration\n-   [\n    Advanced installation\n    ](https://docs.anthropic.com/en/docs/claude-code/setup)\n-   [\n    Identity and Access Management\n    ](https://docs.anthropic.com/en/docs/claude-code/iam)\n-   [\n    Security\n    ](https://docs.anthropic.com/en/docs/claude-code/security)\n-   [\n    Monitoring\n    ](https://docs.anthropic.com/en/docs/claude-code/monitoring-usage)\n-   [\n    Costs\n    ](https://docs.anthropic.com/en/docs/claude-code/costs)\n-   [\n    Analytics\n    ](https://docs.anthropic.com/en/docs/claude-code/analytics)\n##### Configuration\n-   [\n    Settings\n    ](https://docs.anthropic.com/en/docs/claude-code/settings)\n-   [\n    Add Claude Code to your IDE\n    ](https://docs.anthropic.com/en/docs/claude-code/ide-integrations)\n-   [\n    Terminal configuration\n    ](https://docs.anthropic.com/en/docs/claude-code/terminal-config)\n-   [\n    Memory management\n    ](https://docs.anthropic.com/en/docs/claude-code/memory)\n##### Reference\n-   [\n    CLI reference\n    ](https://docs.anthropic.com/en/docs/claude-code/cli-reference)\n-   [\n    Interactive mode\n    ](https://docs.anthropic.com/en/docs/claude-code/interactive-mode)\n-   [\n    Slash commands\n    ](https://docs.anthropic.com/en/docs/claude-code/slash-commands)\n-   [\n    Hooks reference\n    ](https://docs.anthropic.com/en/docs/claude-code/hooks)\n##### Resources\n-   [\n    Data usage\n    ](https://docs.anthropic.com/en/docs/claude-code/data-usage)\n-   [\n    Legal and compliance\n    ](https://docs.anthropic.com/en/docs/claude-code/legal-and-compliance)\nBuild with Claude Code\n# Troubleshooting\nCopy page\nDiscover solutions to common issues with Claude Code installation and usage.\n##\n[​\n](#common-installation-issues)\nCommon installation issues\n###\n[​\n](#windows-installation-issues%3A-errors-in-wsl)\nWindows installation issues: errors in WSL\nYou might encounter the following issues in WSL:\n**OS/platform detection issues**: If you receive an error during installation, WSL may be using Windows `npm`. Try:\n-   Run `npm config set os linux` before installation\n-   Install with `npm install -g @anthropic-ai/claude-code --force --no-os-check` (Do NOT use `sudo`)\n**Node not found errors**: If you see `exec: node: not found` when running `claude`, your WSL environment may be using a Windows installation of Node.js. You can confirm this with `which npm` and `which node`, which should point to Linux paths starting with `/usr/` rather than `/mnt/c/`. To fix this, try installing Node via your Linux distribution’s package manager or via [`nvm`](https://github.com/nvm-sh/nvm).\n###\n[​\n](#linux-installation-issues%3A-permission-errors)\nLinux installation issues: permission errors\nWhen installing Claude Code with npm, you may encounter permission errors if your npm global prefix is not user writable (eg. `/usr`, or `/usr/local`).\n####\n[​\n](#recommended-solution%3A-migrate-to-local-installation)\nRecommended solution: Migrate to local installation\nThe simplest solution is to migrate to a local installation:\n```bash\nclaude migrate-installer\n```\nThis moves Claude Code to `~/.claude/local/` and sets up an alias in your shell configuration. No `sudo` is required for future updates.\nAfter migration, restart your shell, and then verify your installation:\n```bash\nwhich claude  # Should show an alias to ~/.claude/local/claude\nclaude doctor # Check installation health\n```\n####\n[​\n](#alternative-solution%3A-create-a-user-writable-npm-prefix-for-global-installs)\nAlternative solution: Create a user-writable npm prefix for global installs\nYou can configure npm to use a directory within your home folder:\n```bash\n# First, save a list of your existing global packages for later migration\nnpm list -g --depth=0 > ~/npm-global-packages.txt\n# Create a directory for your global packages\nmkdir -p ~/.npm-global\n# Configure npm to use the new directory path\nnpm config set prefix ~/.npm-global\n# Note: Replace ~/.bashrc with ~/.zshrc, ~/.profile, or other appropriate file for your shell\necho 'export PATH=~/.npm-global/bin:$PATH' >> ~/.bashrc\n# Apply the new PATH setting\nsource ~/.bashrc\n# Now reinstall Claude Code in the new location\nnpm install -g @anthropic-ai/claude-code\n# Optional: Reinstall your previous global packages in the new location\n# Look at ~/npm-global-packages.txt and install packages you want to keep\n```\nThis solution:\n-   Avoids modifying system directory permissions\n-   Creates a clean, dedicated location for your global npm packages\n-   Follows security best practices\n####\n[​\n](#system-recovery%3A-if-you-have-run-commands-that-change-ownership-and-permissions-of-system-files-or-similar)\nSystem Recovery: If you have run commands that change ownership and permissions of system files or similar\nIf you’ve already run a command that changed system directory permissions (such as `sudo chown -R $USER:$(id -gn) /usr && sudo chmod -R u+w /usr`) and your system is now broken (for example, if you see `sudo: /usr/bin/sudo must be owned by uid 0 and have the setuid bit set`), you’ll need to perform recovery steps.\n##### Ubuntu/Debian Recovery Method:\n1.  While rebooting, hold **SHIFT** to access the GRUB menu\n2.  Select “Advanced options for Ubuntu/Debian”\n3.  Choose the recovery mode option\n4.  Select “Drop to root shell prompt”\n5.  Remount the filesystem as writable:\n    ```bash\n    mount -o remount,rw /\n    ```\n6.  Fix permissions:\n    ```bash\n    # Restore root ownership\n    chown -R root:root /usr\n    chmod -R 755 /usr\n    # Ensure /usr/local is owned by your user for npm packages\n    chown -R YOUR_USERNAME:YOUR_USERNAME /usr/local\n    # Set setuid bit for critical binaries\n    chmod u+s /usr/bin/sudo\n    chmod 4755 /usr/bin/sudo\n    chmod u+s /usr/bin/su\n    chmod u+s /usr/bin/passwd\n    chmod u+s /usr/bin/newgrp\n    chmod u+s /usr/bin/gpasswd\n    chmod u+s /usr/bin/chsh\n    chmod u+s /usr/bin/chfn\n    # Fix sudo configuration\n    chown root:root /usr/libexec/sudo/sudoers.so\n    chmod 4755 /usr/libexec/sudo/sudoers.so\n    chown root:root /etc/sudo.conf\n    chmod 644 /etc/sudo.conf\n    ```\n7.  Reinstall affected packages (optional but recommended):\n    ```bash\n    # Save list of installed packages\n    dpkg --get-selections > /tmp/installed_packages.txt\n    # Reinstall them\n    awk '{print $1}' /tmp/installed_packages.txt | xargs -r apt-get install --reinstall -y\n    ```\n8.  Reboot:\n    ```bash\n    reboot\n    ```\n##### Alternative Live USB Recovery Method:\nIf the recovery mode doesn’t work, you can use a live USB:\n1.  Boot from a live USB (Ubuntu, Debian, or any Linux distribution)\n2.  Find your system partition:\n    ```bash\n    lsblk\n    ```\n3.  Mount your system partition:\n    ```bash\n    sudo mount /dev/sdXY /mnt  # replace sdXY with your actual system partition\n    ```\n4.  If you have a separate boot partition, mount it too:\n    ```bash\n    sudo mount /dev/sdXZ /mnt/boot  # if needed\n    ```\n5.  Chroot into your system:\n    ```bash\n    # For Ubuntu/Debian:\n    sudo chroot /mnt\n    # For Arch-based systems:\n    sudo arch-chroot /mnt\n    ```\n6.  Follow steps 6-8 from the Ubuntu/Debian recovery method above\nAfter restoring your system, follow the recommended solution above to set up a user-writable npm prefix.\n##\n[​\n](#auto-updater-issues)\nAuto-updater issues\nIf Claude Code can’t update automatically (see [Update Claude Code](https://docs.anthropic.com/en/docs/claude-code/setup#update-claude-code) for how updates work):\n###\n[​\n](#for-permission-errors)\nFor permission errors\nThis is typically due to permission issues with your npm global prefix directory. You have several options:\n1.  **Migrate to local installation** (recommended): Run `claude migrate-installer` to move to a local installation that avoids permission issues entirely\n2.  **Update manually**: Run `claude update` with appropriate permissions\n3.  **Fix npm permissions**: Follow the [recommended solution](https://docs.anthropic.com/_sites/docs.anthropic.com/en/docs/claude-code/troubleshooting#recommended-solution-create-a-user-writable-npm-prefix) above (more complex)\n###\n[​\n](#to-disable-auto-updates)\nTo disable auto-updates\nIf you prefer to control when Claude Code updates:\n```bash\n# Via configuration\nclaude config set autoUpdates false --global\n# Or via environment variable\nexport DISABLE_AUTOUPDATER=1\n```\n###\n[​\n](#to-check-your-installation)\nTo check your installation\n-   **Current version and diagnostics**: Run `claude doctor`\n-   **Check for updates**: Run `claude update`\n-   **View update settings**: Run `claude config get autoUpdates --global`\n-   **Verify installation location**: Run `which claude` - if this shows an alias pointing to `~/.claude/local/claude`, you’re using the recommended local installation\n##\n[​\n](#permissions-and-authentication)\nPermissions and authentication\n###\n[​\n](#repeated-permission-prompts)\nRepeated permission prompts\nIf you find yourself repeatedly approving the same commands, you can allow specific tools to run without approval using the `/permissions` command. See [Permissions docs](https://docs.anthropic.com/en/docs/claude-code/iam#configuring-permissions).\n###\n[​\n](#authentication-issues)\nAuthentication issues\nIf you’re experiencing authentication problems:\n1.  Run `/logout` to sign out completely\n2.  Close Claude Code\n3.  Restart with `claude` and complete the authentication process again\nIf problems persist, try:\n```bash\nrm -rf ~/.config/claude-code/auth.json\nclaude\n```\nThis removes your stored authentication information and forces a clean login.\n##\n[​\n](#performance-and-stability)\nPerformance and stability\n###\n[​\n](#high-cpu-or-memory-usage)\nHigh CPU or memory usage\nClaude Code is designed to work with most development environments, but may consume significant resources when processing large codebases. If you’re experiencing performance issues:\n1.  Use `/compact` regularly to reduce context size\n2.  Close and restart Claude Code between major tasks\n3.  Consider adding large build directories to your `.gitignore` file\n###\n[​\n](#command-hangs-or-freezes)\nCommand hangs or freezes\nIf Claude Code seems unresponsive:\n1.  Press Ctrl+C to attempt to cancel the current operation\n2.  If unresponsive, you may need to close the terminal and restart\n###\n[​\n](#esc-key-not-working-in-jetbrains-intellij%2C-pycharm%2C-etc-terminals)\nESC key not working in JetBrains (IntelliJ, PyCharm, etc.) terminals\nIf you’re using Claude Code in JetBrains terminals and the ESC key doesn’t interrupt the agent as expected, this is likely due to a keybinding clash with JetBrains’ default shortcuts.\nTo fix this issue:\n1.  Go to Settings → Tools → Terminal\n2.  Click the “Configure terminal keybindings” hyperlink next to “Override IDE Shortcuts”\n3.  Within the terminal keybindings, scroll down to “Switch focus to Editor” and delete that shortcut\nThis will allow the ESC key to properly function for canceling Claude Code operations instead of being captured by PyCharm’s “Switch focus to Editor” action.\n##\n[​\n](#getting-more-help)\nGetting more help\nIf you’re experiencing issues not covered here:\n1.  Use the `/bug` command within Claude Code to report problems directly to Anthropic\n2.  Check the [GitHub repository](https://github.com/anthropics/claude-code) for known issues\n3.  Run `/doctor` to check the health of your Claude Code installation\n4.  Ask Claude directly about its capabilities and features - Claude has built-in access to its documentation\nWas this page helpful?\nYesNo\n[Model Context Protocol (MCP)](https://docs.anthropic.com/en/docs/claude-code/mcp)[Overview](https://docs.anthropic.com/en/docs/claude-code/third-party-integrations)\n[x](https://x.com/AnthropicAI)[linkedin](https://www.linkedin.com/company/anthropicresearch)[discord](https://www.anthropic.com/discord)\nOn this page\n-   [Common installation issues](#common-installation-issues)\n-   [Windows installation issues: errors in WSL](#windows-installation-issues%3A-errors-in-wsl)\n-   [Linux installation issues: permission errors](#linux-installation-issues%3A-permission-errors)\n-   [Recommended solution: Migrate to local installation](#recommended-solution%3A-migrate-to-local-installation)\n-   [Alternative solution: Create a user-writable npm prefix for global installs](#alternative-solution%3A-create-a-user-writable-npm-prefix-for-global-installs)\n-   [System Recovery: If you have run commands that change ownership and permissions of system files or similar](#system-recovery%3A-if-you-have-run-commands-that-change-ownership-and-permissions-of-system-files-or-similar)\n-   [Auto-updater issues](#auto-updater-issues)\n-   [For permission errors](#for-permission-errors)\n-   [To disable auto-updates](#to-disable-auto-updates)\n-   [To check your installation](#to-check-your-installation)\n-   [Permissions and authentication](#permissions-and-authentication)\n-   [Repeated permission prompts](#repeated-permission-prompts)\n-   [Authentication issues](#authentication-issues)\n-   [Performance and stability](#performance-and-stability)\n-   [High CPU or memory usage](#high-cpu-or-memory-usage)\n-   [Command hangs or freezes](#command-hangs-or-freezes)\n-   [ESC key not working in JetBrains (IntelliJ, PyCharm, etc.) terminals](#esc-key-not-working-in-jetbrains-intellij%2C-pycharm%2C-etc-terminals)\n-   [Getting more help](#getting-more-help)",
  "timestamp": 1753484561993,
  "title": "Troubleshooting - Anthropic"
}